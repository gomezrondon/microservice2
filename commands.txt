//linux
cd ../..

//Docker
docker-machine ls
docker-machine restart default
#cuando se desconfigura el docker machine, eje: Cannot connect to the Docker daemon
eval "$(docker-machine env default)"

docker images
docker ps -a
docker build -t gomezrondon/spring-config:latest .

docker-compose build
docker-compose up -d
docker-compose down
docker-compose up -d --scale feign-car-service=2 --scale car-service=2

-- remove container
docker rm <container name>
docker-compose -f docker-mysql.yml up -d
docker-compose -f docker-mongo.yml up -d
docker-compose -f docker-rabbitmq.yml up -d

---------------JIB
gradle -x test jibDockerBuild -Djib.container.environment=spring.profiles.active=docker
gradlew bootBuildImage --imageName=springio/gs-spring-boot-docker
--------------------
// borrar images y forzar
docker images | grep "none" | awk '{print $3}' | xargs docker rmi -f

//borrar una imagen
docker images -a | grep "pepe" | awk '{print $3}' | xargs docker rmi
//borrar un contenedor
docker ps -a | grep "pepe" | awk '{print $1}' | xargs docker rm

--------- generar las images 
gradle loadTarImage   (es todo!!!)

http://192.168.99.100:8080/v2/cool-cars

gradle -x test jibDockerBuild -Djib.container.environment=spring.profiles.active=docker

------------- spring boot 2.3
1) crear images:
gradle clean bootBuildImage
2) to run docker compose:
docker-compose up -d
3) how to push to gcp registry:
https://cloud.google.com/container-registry/docs/pushing-and-pulling
3.1) from time to time it ask for credentials
gcloud auth configure-docker
3.2) we push to registry
docker push gcr.io/ut-265822/car-service:v1
4) execute on each service:
gradle skaRun -Pcommand=deploy
gradle skaRun -Pcommand=delete
5) we check the results:
kubectl get deployment

---- pre requisitos
intallar skaffold
activar kubernetes
------------- kubernetes in GCP
gcloud container clusters get-credentials <CLUSTER-NAME> --zone <ZONE>
kubectl get pods

kubectl logs <POD-FULL-NAME>
kubectl logs -f <POD-FULL-NAME>  // continue streaming

kubectl get pod -w   // watch the pods

kubectl logs -f car-service-578b7fb6c6-btd4g

----------- skaffold
skaffold build // para contruir la imagen
skaffold deploy  // deploya

gradle skaRun                   //deploy all services
gradle skaRun -Pcommand=delete  //destroy all service
gradle skaRun -Pcommand=deploy
kubectl get deployment
-------------
https://spring.io/guides/gs/spring-boot-kubernetes/
kubectl create deployment app-gateway --image=spring-gateway:v1 --dry-run -o=yaml > deployment.yaml
kubectl create service clusterip app-gateway --tcp=8080:8080 --dry-run -o=yaml >> deployment.yaml
kubectl apply -f deploy-app.yaml
kubectl apply -f app-service.yaml
kubectl port-forward svc/spring-gateway 8080:8080
kubectl port-forward svc/car-service 8081:8081
kubectl port-forward svc/feign-car-service 8082:8082
kubectl port-forward svc/eureka-service 8761:8761
kubectl delete -f deploy-app.yaml
kubectl delete -f app-service.yaml
------------
kubectl run eureka-service --image=gcr.io/ut-265822/eureka-service:v1 --port 8761
kubectl run car-service --image=gcr.io/ut-265822/car-service:v1
kubectl run feign-car-service --image=gcr.io/ut-265822/feign-car-service:v1
kubectl run spring-gateway --image=gcr.io/ut-265822/spring-gateway:v1 --port 8080

kubectl get deployment

------------!!!!Asi es que se borra un F. pod/deployment
kubectl delete deployment spring-gateway
kubectl delete deployment eureka-service
kubectl delete deployment feign-car-service
kubectl delete deployment car-service

kubectl get services

kubectl expose deployment spring-gateway --type=LoadBalancer

kubectl delete service spring-gateway

------------- with config files
kubectl apply -f k-deployment.yml
# como destruir el deployment
kubectl delete -f k-deployment.yml